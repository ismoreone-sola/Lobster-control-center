<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sola Real-Voice Recorder</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #f4f7f6; margin: 0; padding: 0; color: #333; }
        .container { max-width: 800px; margin: 20px auto; background: #fff; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.08); padding: 25px; }
        header { text-align: center; border-bottom: 2px solid #f0f0f0; margin-bottom: 25px; padding-bottom: 15px; }
        .logo { font-size: 1.8em; font-weight: 800; color: #007bff; letter-spacing: -1px; }
        
        .voice-section { background: #fdfdfd; border: 2px solid #eef2f3; border-radius: 20px; padding: 30px 20px; text-align: center; margin-bottom: 30px; }
        #recordButton { background: #28a745; color: white; border: none; padding: 18px 35px; border-radius: 50px; font-size: 1.2em; font-weight: bold; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(40,167,69,0.3); width: 100%; max-width: 300px; }
        #recordButton:disabled { background: #ccc; box-shadow: none; cursor: not-allowed; }
        #recordButton.recording { background: #dc3545; animation: pulse 1.5s infinite; }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(220,53,69,0.7); } 70% { box-shadow: 0 0 0 15px rgba(220,53,69,0); } 100% { box-shadow: 0 0 0 0 rgba(220,53,69,0); } }
        
        #statusText { margin-top: 15px; font-weight: bold; color: #666; }
        
        .log-container { text-align: left; }
        .log-header { font-size: 1.1em; font-weight: 700; margin-bottom: 10px; color: #444; display: flex; justify-content: space-between; align-items: center; }
        #clearBtn { font-size: 0.7em; background: #eee; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        #transcriptionLog { padding: 15px; background: #f8f9fa; border-radius: 12px; min-height: 150px; border: 1px solid #eee; overflow-y: auto; max-height: 400px; }
        .log-entry { padding: 12px; border-bottom: 1px solid #e1e4e8; animation: fadeIn 0.4s ease; background: white; margin-bottom: 8px; border-radius: 8px; }
        .log-time { color: #007bff; font-weight: bold; font-size: 0.85em; margin-right: 10px; display: block; margin-bottom: 4px; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        @media (max-width: 600px) {
            .container { margin: 10px; padding: 15px; }
            #recordButton { max-width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">SOLA REAL-VOICE ğŸ™ï¸</div>
        </header>

        <div class="voice-section">
            <button id="recordButton">ğŸ¤ é–‹å§‹è½å–ç•™è¨€ (10ç§’)</button>
            <div id="statusText">ç³»çµ±å°±ç·’</div>
        </div>

        <div class="log-container">
            <div class="log-header">
                <span>ç•™è¨€ç´€éŒ„ (è‡ªå‹•å„²å­˜)</span>
                <button id="clearBtn">æ¸…é™¤å…¨éƒ¨</button>
            </div>
            <div id="transcriptionLog">
                <div id="emptyMsg" style="color:#999; text-align:center; padding-top:40px;">å°šæœªæœ‰ç´€éŒ„</div>
            </div>
        </div>

        <footer style="margin-top:40px; text-align:center; color:#ccc; font-size:0.8em; padding-bottom: 20px;">
            &copy; 2026 Sola Assistant Â· æ”¯æ´ iOS/Android èªéŸ³è¾¨è­˜
        </footer>
    </div>

    <script>
        const btn = document.getElementById('recordButton');
        const status = document.getElementById('statusText');
        const log = document.getElementById('transcriptionLog');
        const clearBtn = document.getElementById('clearBtn');
        const emptyMsg = document.getElementById('emptyMsg');

        // åˆå§‹åŒ–ï¼šå¾ LocalStorage è®€å–èˆŠç´€éŒ„
        let savedLogs = JSON.parse(localStorage.getItem('sola_voice_logs') || '[]');
        renderLogs();

        // æª¢æŸ¥ç€è¦½å™¨æ”¯æ´
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
            status.innerText = "æŠ±æ­‰ï¼Œæ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è¾¨è­˜æœå‹™ã€‚";
            btn.disabled = true;
        }

        function renderLogs() {
            if (savedLogs.length > 0) {
                emptyMsg.style.display = 'none';
                log.innerHTML = '';
                savedLogs.forEach(entry => {
                    const html = `<div class="log-entry"><span class="log-time">${entry.time}</span>${entry.text}</div>`;
                    log.insertAdjacentHTML('afterbegin', html);
                });
            } else {
                emptyMsg.style.display = 'block';
                log.innerHTML = '';
                log.appendChild(emptyMsg);
            }
        }

        function saveMessage(text) {
            const now = new Date();
            const timeStr = `${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
            savedLogs.push({ time: timeStr, text: text });
            localStorage.setItem('sola_voice_logs', JSON.stringify(savedLogs));
            renderLogs();
        }

        clearBtn.onclick = () => {
            if(confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰ç´€éŒ„å—ï¼Ÿ')) {
                savedLogs = [];
                localStorage.removeItem('sola_voice_logs');
                renderLogs();
            }
        };

        let recognition;
        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = 'zh-HK'; // é è¨­å»£æ±è©±ï¼Œå¯æ”¹ zh-CN
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            recognition.onstart = () => {
                isRecording = true;
                btn.classList.add('recording');
                btn.innerText = 'ğŸ›‘ æ­£åœ¨è½å–è¨Šæ¯...';
                status.innerText = 'æ­£åœ¨è½å–æ‚¨çš„è²éŸ³ (é™æ™‚10ç§’)...';
            };

            recognition.onresult = (event) => {
                const speechResult = event.results[0][0].transcript;
                saveMessage(speechResult);
            };

            recognition.onspeechend = () => {
                recognition.stop();
            };

            recognition.onend = () => {
                btn.classList.remove('recording');
                btn.innerText = 'ğŸ¤ é–‹å§‹è½å–ç•™è¨€ (10ç§’)';
                status.innerText = 'éŒ„éŸ³çµæŸï¼Œå·²å„²å­˜ã€‚';
                isRecording = false;
            };

            recognition.onerror = (event) => {
                status.innerText = 'è¾¨è­˜å‡ºéŒ¯: ' + event.error;
                btn.classList.remove('recording');
                isRecording = false;
            };
        }

        btn.onclick = () => {
            if (!recognition) return;
            try {
                recognition.start();
                // 10ç§’å¾Œå¼·åˆ¶çµæŸ
                setTimeout(() => {
                    recognition.stop();
                }, 10000);
            } catch (e) {
                console.log('Recognition already started');
            }
        };
    </script>
</body>
</html>